<!DOCTYPE html>
<html lang="und" style="width:100%;height:100%;background-color:black;">
    <head>
        <meta charset="UTF-8">
        <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
        <meta name="description" content="Eaglercraft 1.12 test directory HTML page">
        <meta name="keywords" content="eaglercraft, eaglercraftx, minecraft, 1.12, 1.12.2">
        <title>Eaglercraft 1.12.2</title>
        <meta property="og:locale" content="en-US">
        <meta property="og:type" content="website">
        <meta property="og:title" content="Eaglercraft 1.12.2">
        <meta property="og:description" content="test directory HTML page">
        <link type="image/png" rel="shortcut icon" href="favicon.png">
        <style>
            #splash-screen {
                position: fixed;
                top: 0;
                left: 0;
                width: 100%;
                height: 100%;
                background-color: black;
                display: flex;
                justify-content: center;
                align-items: center;
                z-index: 1000;
            }
            #splash-screen img {
                max-width: 50%;
                max-height: 50%;
            }
            #splash-screen.hidden {
                display: none;
            }
        </style>
    </head>
    <body style="margin:0px;width:100%;height:100%;overflow:hidden;background-color:black;" id="game_frame">
        <div id="splash-screen">
            <img src="your_splash_image.png" alt="Custom Splash Screen">
        </div>
        <script type="text/javascript">
            "use strict";
            window.addEventListener("load", async function() {
                // Set flags to indicate main splash screen is active and suppress others
                window.isSplashScreenActive = true;
                window.suppressSplashScreens = true;

                // Show splash screen for 5 seconds
                const splashScreen = document.getElementById("splash-screen");
                await new Promise(resolve => setTimeout(resolve, 5000));

                // Clear isSplashScreenActive flag but keep suppressSplashScreens
                window.isSplashScreenActive = false;

                // MutationObserver to suppress or modify splash screens from classes.js
                const observer = new MutationObserver((mutations) => {
                    mutations.forEach((mutation) => {
                        mutation.addedNodes.forEach((node) => {
                            if (node.nodeName === "IMG") {
                                // Replace image source with custom splash image
                                node.src = "your_splash_image.png";
                                // Alternatively, hide the image if it's an unwanted splash screen
                                if (window.suppressSplashScreens) {
                                    node.style.display = "none";
                                }
                            } else if (node.nodeType === 1 && node.querySelectorAll) {
                                // Check for images in added elements
                                const images = node.querySelectorAll("img");
                                images.forEach((img) => {
                                    img.src = "your_splash_image.png";
                                    if (window.suppressSplashScreens) {
                                        img.style.display = "none";
                                    }
                                });
                            }
                        });
                    });
                });
                observer.observe(document.body, { childList: true, subtree: true });

                // Dynamically load scripts
                const classesScript = document.createElement("script");
                classesScript.src = "classes.js";
                document.head.appendChild(classesScript);

                const ga4Script = document.createElement("script");
                ga4Script.src = "/js/ga4.js";
                document.head.appendChild(ga4Script);

                // Wait for classes.js to load before proceeding
                await new Promise(resolve => {
                    classesScript.onload = resolve;
                });

                // Simulate 20 key presses (Enter key)
                for (let i = 0; i < 20; i++) {
                    const keyEvent = new KeyboardEvent("keydown", {
                        key: "Enter",
                        code: "Enter",
                        keyCode: 13,
                        which: 13,
                        bubbles: true,
                        cancelable: true
                    });
                    document.dispatchEvent(keyEvent);
                }

                // Hide splash screen after scripts are loaded and game is initialized
                splashScreen.classList.add("hidden");

                // Stop observing after initialization to avoid performance issues
                observer.disconnect();

                // Original initialization code
                if (window.location.href.indexOf("file:") === 0) {
                    alert("HTTP please, do not open this file locally, run a local HTTP server and load it via HTTP");
                } else {
                    var relayId = Math.floor(Math.random() * 3);
                    window.eaglercraftXOpts = {
                        demoMode: false,
                        container: "game_frame",
                        assetsURI: "assets.epk",
                        localesURI: "lang/",
                        worldsDB: "worlds",
                        servers: []
                    };
                    main();
                }
            });

            // Note: Since classes.js is obfuscated, this script uses a MutationObserver
            // to detect and suppress or modify any <img> elements it adds, setting their
            // src to your_splash_image.png or hiding them. If you need to modify classes.js
            // directly, search for .png strings to find image paths and replace them with
            // your_splash_image.png, or use a deobfuscation tool like JS Beautifier.
        </jonas:// If classes.js or ga4.js don't respect window.suppressSplashScreens,
        // their splash screens are suppressed via the MutationObserver.
        </script>
    </body>
</html>
