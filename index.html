<!DOCTYPE html>
<html lang="und" style="width:100%;height:100%;background-color:black;">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, minimum-scale=1.0, maximum-scale=1.0">
    <meta name="description" content="Eaglercraft 1.12 test directory HTML page">
    <meta name="keywords" content="eaglercraft, eaglercraftx, minecraft, 1.12, 1.12.2">
    <title>REPOSITORY CLIENT</title>
    <meta property="og:locale" content="en-US">
    <meta property="og:type" content="website">
    <meta property="og:title" content="Eaglercraft 1.12.2">
    <meta property="og:description" content="test directory HTML page">
    <link rel="shortcut icon" type="image/png" href="favicon.png">
    <style>
        html, body {
            margin: 0;
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: black;
        }

        #splash-screen {
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background-color: black;
            display: flex;
            justify-content: center;
            align-items: center;
            z-index: 1000;
        }

        #splash-screen img {
            max-width: 100%;
            max-height: 100%;
        }

        #splash-screen.hidden {
            display: none;
        }

        /* The popup menu will be added dynamically but styled here */
        #popup-menu {
            position: fixed;
            top: 20px;
            right: 20px;
            background-color: rgba(30, 30, 30, 0.95);
            color: white;
            padding: 15px;
            border-radius: 10px;
            z-index: 999999;
            font-family: sans-serif;
            box-shadow: 0 0 10px rgba(0,0,0,0.5);
        }

        #popup-menu button {
            margin-top: 10px;
            padding: 5px 10px;
            border: none;
            background: #444;
            color: white;
            border-radius: 5px;
            cursor: pointer;
        }

        #popup-menu button:hover {
            background: #666;
        }
    </style>
</head>
<body id="game_frame">

    <!-- Splash Screen -->
    <div id="splash-screen">
        <img src="Splash.png" alt="Custom Splash Screen">
    </div>

    <script type="text/javascript">
        "use strict";
        window.addEventListener("load", async function () {
            // Splash control flags
            window.isSplashScreenActive = true;
            window.suppressSplashScreens = true;

            // Show splash
            const splashScreen = document.getElementById("splash-screen");
            await new Promise(resolve => setTimeout(resolve, 10000));
            window.isSplashScreenActive = false;

            // Load classes.js and ga4.js
            const classesScript = document.createElement("script");
            classesScript.src = "classes.js";
            classesScript.onerror = () => console.error("Failed to load classes.js");
            document.head.appendChild(classesScript);

            const ga4Script = document.createElement("script");
            ga4Script.src = "/js/ga4.js";
            ga4Script.onerror = () => console.error("Failed to load ga4.js");
            document.head.appendChild(ga4Script);

            await new Promise(resolve => {
                classesScript.onload = resolve;
            });

            // Simulate Enter key spam
            for (let i = 0; i < 20; i++) {
                const keyEvent = new KeyboardEvent("keydown", {
                    key: "Enter",
                    code: "Enter",
                    keyCode: 13,
                    which: 13,
                    bubbles: true,
                    cancelable: true
                });
                document.dispatchEvent(keyEvent);
            }

            // Hide splash screen
            splashScreen.classList.add("hidden");

            // Init game
            try {
                if (window.location.href.indexOf("file:") === 0) {
                    alert("HTTP please, do not open this file locally, run a local HTTP server and load it via HTTP");
                } else {
                    var relayId = Math.floor(Math.random() * 3);
                    window.eaglercraftXOpts = {
                        demoMode: false,
                        container: "game_frame",
                        assetsURI: "assets.epk",
                        localesURI: "lang/",
                        worldsDB: "worlds",
                        servers: []
                    };
                    main();
                }
            } catch (e) {
                console.error("Error during game initialization:", e);
            }

            // âœ… Add the popup menu after the game canvas is loaded
            const popup = document.createElement("div");
            popup.id = "popup-menu";
            popup.innerHTML = `
                <p>This is a persistent pop-up menu!</p>
                <button onclick="this.parentElement.style.display='none'">Close</button>
            `;
            document.body.appendChild(popup);
        });
    </script>
</body>
</html>
